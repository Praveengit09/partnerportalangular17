<div (click)="hideSearchResult()">
    <div class="col-md-12 col-sm-12 col-xs-12 advice_text">
        <h1 class="page-title">Add Stock</h1>
    </div>

    <!-- add product code start here -->

    <h4>Add New Product</h4>
    <div class="row">
        <div class="col-lg-12">
            <section class="widget_txt" widget="">
                <div class="row">
                    <div class="col-lg-3 col-md-6 col-sm-6 col-xs-12">

                        <label>Product Name<sup class="sgst_txt">*</sup></label>
                        <hs-select *ngIf="hsSelectBoolean" [defaultSelectLabel]="'Product Name'"
                            [selectColumns]="selectColumns" [defaultSelected]="pharmacyProducts"
                            [defaultSelectField]="'productName'" [selectTotal]="productNameSelectTotal"
                            [selectResults]="productNameSearchResults" [hardReset]="productNameHardReset"
                            [multiCheckVarName]="'productId'" (searchTrigger)="productNameSearchTrigger($event)"
                            (selectTrigger)="selectTrigger($event)">
                        </hs-select>
                    </div>
                    <div class="col-lg-3 col-md-6 col-sm-6 col-xs-12">

                        <label>Product Code</label>
                        <hs-select *ngIf="hsSelectBoolean" [defaultSelectLabel]="'Product Code'"
                            [selectColumns]="selectColumns" [defaultSelected]="pharmacyProducts"
                            [defaultSelectField]="'productCode'" [selectTotal]="productCodeSelectTotal"
                            [selectResults]="productCodeSearchResults" [hardReset]="productCodeHardReset"
                            [multiCheckVarName]="'productId'" (searchTrigger)="productCodeSearchTrigger($event)"
                            (selectTrigger)="selectTrigger($event)"></hs-select>
                    </div>

                    <div class="col-lg-3 col-md-6 col-sm-6 col-xs-12">
                        <div class="form-group">
                            <label>Quantity<sup class="sgst_txt">*</sup></label>
                            <input type="number" name="quantity"
                                [(ngModel)]="pharmacyProducts.stockDetails.purchasedQuantity" id="quantity"
                                class="form-control input-sm" placeholder="Quantity" min="0"
                                oninput="validity.valid||(value='');">
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-6 col-sm-6 col-xs-12">
                        <div class="form-group">
                            <label>Free<sup class="sgst_txt">*</sup></label>
                            <input type="number" name="first_name" [(ngModel)]="pharmacyProducts.freeProductCount"
                                id="free" class="form-control input-sm" placeholder="Free" min="0"
                                oninput="validity.valid||(value='');">
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-lg-3 col-md-6 col-sm-6 col-xs-12">
                        <label>Composition<sup class="sgst_txt">*</sup></label>
                        <hs-select *ngIf="hsSelectBoolean" [defaultSelectLabel]="'Composition'"
                            [selectColumns]="selectColumns" [defaultSelected]="pharmacyProducts"
                            [defaultSelectField]="'genericMedicine.genericMedicineName'"
                            [selectTotal]="genericNameSelectTotal" [selectResults]="genericNameSearchResults"
                            [multiCheckVarName]="'productId'" [hardReset]="genericNameHardReset"
                            (searchTrigger)="genericNameSearchTrigger($event)" (selectTrigger)="selectTrigger($event)">
                        </hs-select>
                    </div>
                    <div class="col-lg-3 col-md-6 col-sm-6 col-xs-12">
                        <div class="form-group">
                            <label>Expiry<sup class="sgst_txt">*</sup></label>
                            <hs-datepicker *ngIf="hsSelectBoolean" (onDateSubmit)="onDateSubmit($event)"
                                [defautDate]="expiryDatee"></hs-datepicker>
                        </div>
                    </div>

                    <div class="col-lg-3 col-md-6 col-sm-6 col-xs-12">
                        <div class="form-group">
                            <label>Batch Number<sup class="sgst_txt">*</sup></label>
                            <input type="text" name="batch_number" [(ngModel)]="pharmacyProducts.stockDetails.batchNo"
                                id="batch_number" class="form-control input-sm" placeholder="Batch No" min="0"
                                oninput="validity.valid||(value='');">
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-6 col-sm-6 col-xs-12">
                        <div class="form-group">
                            <label>Manufacturer Name</label>
                            <input type="text" name="company_name" [(ngModel)]="pharmacyProducts.brandName"
                                id="companyName" class="form-control input-sm" placeholder="Manufacturer Name">
                        </div>
                    </div>

                </div>

                <div class="row">
                    <div class="col-lg-3 col-md-6 col-sm-6 col-xs-12">
                        <div class="form-group">
                            <label>Package Type<sup class="sgst_txt">*</sup></label>
                            <select name="PackageType" id="PackageType" class="form-control input-sm"
                                [(ngModel)]="pharmacyProducts.packingInformation.packageType">
                                <option
                                    value="{{pharmacyProducts.packingInformation.packageType?'package':'undefined'}}">
                                    --Select Pack Type--</option>
                                <option value="Strip">Strip</option>
                                <option value="Bottle">Bottle</option>
                                <option value="Jar">Jar</option>
                                <option value="Empty">None Of These</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-6 col-sm-6 col-xs-12">
                        <div class="form-group">
                            <label>Units Per Package <sup class="sgst_txt">*</sup></label>
                            <input type="text" name="package_name"
                                [(ngModel)]="pharmacyProducts.packingInformation.unitsInPackage" id="package_quantity"
                                class="form-control input-sm" placeholder="Package"
                                (keypress)="validation.onlyNumbers($event)">
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-6 col-sm-6 col-xs-12">
                        <div class="form-group">
                            <label>Schedule<sup class="sgst_txt">*</sup></label>
                            <input type="text" name="first_name" [(ngModel)]="pharmacyProducts.schedule" id="schedule"
                                class="form-control input-sm" placeholder="Schedule">
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-6 col-sm-6 col-xs-12">
                        <div class="form-group">
                            <label>Rack<sup class="sgst_txt">*</sup></label>
                            <input type="text" name="rack_number" [(ngModel)]="pharmacyProducts.stockDetails.rackNo"
                                id="rack_number" class="form-control input-sm" placeholder="Rack No">
                        </div>
                    </div>
                </div>

                <div class="row" *ngIf="pharmacyProducts.packingInformation as packInfo">
                    <div class="col-lg-3 col-md-6 col-sm-6 col-xs-12">
                        <div class="form-group">
                            <label>MRP (per {{packInfo.packageType?packInfo.packageType:'package'}})<sup
                                    class="sgst_txt">*</sup></label>
                            <input type="text"
                                onkeypress='return event.charCode >= 48 && event.charCode <= 57|| event.charCode === 46'
                                name="first_name" [(ngModel)]="pharmacyProducts.stockDetails.packageNetPrice" id="price"
                                class="form-control input-sm" placeholder="Price" min="0"
                                (keypress)="validation.decimalValueforTwoCharacters($event)"
                                (keyup)="onMarginCalculate()" (change)="onMarginCalculate()"
                                oninput="validity.valid||(value='');">
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-6 col-sm-6 col-xs-12">
                        <div class="form-group">
                            <label>Selling Rate (per {{packInfo.packageType?packInfo.packageType:'package'}})<sup
                                    class="sgst_txt">*</sup></label>
                            <input type="text"
                                onkeypress='return event.charCode >= 48 && event.charCode <= 57|| event.charCode === 46'
                                name="purchase_rate" [(ngModel)]="pharmacyProducts.purchaseRate" id="purchase_rate"
                                class="form-control input-sm" placeholder="Selling Rate" (keyup)="onMarginCalculate()"
                                (keypress)="validation.decimalValueforTwoCharacters($event)"
                                (change)="onMarginCalculate()" min="0" oninput="validity.valid||(value='');">
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-6 col-sm-6 col-xs-12">
                        <div class="form-group">
                            <label>Margin %<sup class="sgst_txt">*</sup></label>
                            <input type="number" name="first_name" disabled
                                [(ngModel)]="pharmacyProducts.marginPercentage" id="margin_percentage"
                                class="form-control input-sm" placeholder="Margin" min="0"
                                (keypress)="validation.decimalValueforTwoCharacters($event)"
                                oninput="validity.valid||(value='');" step="0.01">
                        </div>
                    </div>

                    <div class="col-lg-3 col-md-6 col-sm-6 col-xs-12">
                        <div class="form-group">
                            <label>Drug Form<sup class="sgst_txt">*</sup></label>
                            <input type="text" name="Drug_Form" [(ngModel)]="pharmacyProducts.drugForm" id="drugForm"
                                class="form-control input-sm" placeholder="Drug Form">
                        </div>
                    </div>

                    <div class="col-lg-3 col-md-6 col-sm-6 col-xs-12">
                        <div class="form-group">
                            <label>Marketed By</label>
                            <input type="text" name="Drug_Form" [(ngModel)]="pharmacyProducts.marketedBy" id="drugForm"
                                class="form-control input-sm" placeholder="Marketed By">
                        </div>
                    </div>
                </div>
                <br>
                <b>Taxes<sup class="sgst_txt">*</sup></b>
                <hr>
                <div class="row">
                    <div class="col-lg-4 col-md-6 col-sm-6 col-xs-12">
                        <div class="form-group">
                            <mat-form-field appearance="outline">
                                <mat-label>Seller CGST %</mat-label>
                                <input matInput id="margin_percentage" class="form-control input-sm"
                                    placeholder="Seller CGST" autocomplete="off" name="seller_cgst"
                                    [(ngModel)]="pharmacyProducts.stockDetails.taxes.cgst" (keyup)="validGst()"
                                    (keypress)="validation.decimalValueforTwoCharacters($event)" step="0.01"
                                    onkeypress='return event.charCode >= 48 && event.charCode <= 57|| event.charCode === 46' />
                            </mat-form-field>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-6 col-sm-6 col-xs-12">
                        <div class="form-group">
                            <mat-form-field appearance="outline">
                                <mat-label>Seller SGST %</mat-label>
                                <input matInput id="margin_percentage" class="form-control input-sm"
                                    placeholder="Seller SGST" autocomplete="off" name="seller_sgst"
                                    [(ngModel)]="pharmacyProducts.stockDetails.taxes.sgst" (keyup)="validGst()"
                                    (keypress)="validation.decimalValueforTwoCharacters($event)" step="0.01"
                                    onkeypress='return event.charCode >= 48 && event.charCode <= 57|| event.charCode === 46' />
                            </mat-form-field>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-6 col-sm-6 col-xs-12">
                        <div class="form-group">
                            <mat-form-field appearance="outline">
                                <mat-label>Seller IGST %</mat-label>
                                <input matInput id="margin_percentage" class="form-control input-sm"
                                    placeholder="Seller IGST" autocomplete="off" name="seller_igst"
                                    [(ngModel)]="pharmacyProducts.stockDetails.taxes.igst" (keyup)="validGst()"
                                    (keypress)="validation.decimalValueforTwoCharacters($event)" step="0.01"
                                    onkeypress='return event.charCode >= 48 && event.charCode <= 57|| event.charCode === 46' />
                            </mat-form-field>
                        </div>
                    </div>
                </div>
                <p class="ErrorMessage">{{addProductError}}</p>
                <p class="ErrorMessage">{{addGstPercentError}}</p>
                <input type="submit" class="Update" value="ADD PRODUCT" (click)="addProduct()">
            </section>
        </div>


        <h4>Product Details</h4>
        <div class="row">
            <div class="col-lg-12">
                <section class="widget table_pading inventory_widget widget-shadow" widget>
                    <div class="widget-body">
                        <div class="table-responsive table-datalabel">
                            <table class="table product_table new_table table-striped">
                                <thead>
                                    <tr class="table_head">
                                        <th>Product Code</th>
                                        <th>Name</th>
                                        <th>Batch No.</th>
                                        <th>Expiry</th>
                                        <th>MRP</th>
                                        <th>Selling Rate</th>
                                        <th>Margin %</th>
                                        <th>CGST %</th>
                                        <th>SGST %</th>
                                        <th>IGST %</th>
                                        <th>Quantity</th>
                                        <th>Total Price</th>
                                        <th>&nbsp;</th>
                                    </tr>

                                </thead>
                                <tbody>
                                    <tr *ngFor="let pharmacyproductdetailList of pharmacyProductDisplayList; let i=index"
                                        class="inventory_medic">
                                        <td data-label="Product Code">
                                            <div class="tabledatalabel-right">
                                                {{pharmacyproductdetailList.selectedProductCode}}</div>
                                        </td>
                                        <td data-label="Name">
                                            <div class="tabledatalabel-right">
                                                {{pharmacyproductdetailList.selectedProductname}}</div>
                                        </td>
                                        <td data-label="Batch No.">
                                            <div class="tabledatalabel-right">
                                                {{pharmacyproductdetailList.selectedBatchNumber}}</div>
                                        </td>
                                        <td data-label="Expiry">
                                            <div class="tabledatalabel-right">
                                                {{getDate(pharmacyproductdetailList.selectedExpiry)}}</div>
                                        </td>
                                        <td data-label="MRP">
                                            <div class="tabledatalabel-right">&#8377;
                                                {{pharmacyproductdetailList.selectedNetPrice}}
                                            </div>
                                        </td>
                                        <td data-label="Selling Rate">
                                            <div class="tabledatalabel-right">&#8377;
                                                {{pharmacyproductdetailList.selectedPurchaseRate}}
                                            </div>
                                        </td>
                                        <td data-label="Margin %">
                                            <div class="tabledatalabel-right">
                                                {{pharmacyproductdetailList.selectedMarginPercent}}</div>
                                        </td>
                                        <td data-label="CGST %">
                                            <div class="tabledatalabel-right">{{pharmacyproductdetailList.cgst}}</div>
                                        </td>
                                        <td data-label="SGST %">
                                            <div class="tabledatalabel-right">{{pharmacyproductdetailList.sgst}}</div>
                                        </td>
                                        <td data-label="IGST %">
                                            <div class="tabledatalabel-right">{{pharmacyproductdetailList.igst}}</div>
                                        </td>
                                        <td data-label="Quantity">
                                            <div class="tabledatalabel-right">
                                                {{pharmacyproductdetailList.selectedQuantity}}
                                            </div>
                                        </td>
                                        <td data-label="Total Price">
                                            <div class="tabledatalabel-right">&#8377;
                                                {{pharmacyproductdetailList.selectedTotalAmount}}
                                            </div>
                                        </td>
                                        <td>
                                            <div class="tabledatalabel-right">
                                                <button class="btn btn-danger" (click)="editproduct(i);">Edit</button>
                                                <button class="btn btn-danger remove-btn"
                                                    (click)="remove(i)">Remove</button>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </section>
            </div>
        </div>
        <br>
    </div>

    <div class="row">
        <div class="col-lg-9">
            <p class="ErrorMessage">{{supplierError}}</p>
        </div>
        <div class="col-lg-3 right">
            <button type="button" class="Update" role="button" (click)="updateInventory()">UPDATE INVENTORY
            </button>
        </div>
    </div>

    <div class="modal fade" id="successMessage" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header" *ngIf="insertResult != undefined">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                            aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">{{insertResult.statusMessage}}</h4>
                </div>
                <div class="modal-body">
                    <p>{{successMessage}}</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
</div>
<spinner-component></spinner-component>